import{n as e,y as t}from"./lit-element-d78ce8b8.js";class n extends e{static get properties(){return{pub:{type:String},sub:{type:String},set:{type:String},get:{type:String},func:{type:String}}}constructor(){super(),n.Server={server:"wss://mqtt1.webduino.io/mqtt",userName:"webduino",password:"webduino"},n.subs={}}async publish(e,t){await n.mClient.send({topic:e,message:""+t})}async firstUpdated(){var e=this;if(n.mClient||(n.isConnect=!1,n.mClient=new webduino.module.mqttClient,await n.mClient.connect(n.Server),console.log("mqttClient connect ok"),n.isConnect=!0),e.pub){var t=e.get.split("."),s=t[0],i=t[1],a=document.getElementById(s);"on"==i&&"MWC-ICON-BUTTON-TOGGLE"==a.tagName?a.addEventListener("icon-button-toggle-change",(function(t){n.mClient.send({topic:e.pub,message:""+t.detail.isOn})})):"input"==i&&"MWC-SLIDER"==a.tagName?a.addEventListener("input",(function(t){n.mClient.send({topic:e.pub,message:""+parseInt(this.value)})})):"checked"==i&&"MWC-SWITCH"==a.tagName&&a.addEventListener("input",(function(t){n.mClient.send({topic:e.pub,message:""+(1!=this.checked)})}))}if(e.sub)var u=setInterval((async function(){n.isConnect&&(n.subs[e.sub]||(n.subs[e.sub]=[],await n.mClient.onMessage(e.sub,(async t=>{for(var s=n.subs[e.sub],i=0;i<s.length;i++)s[i](t)}))),n.subs[e.sub].push((async t=>{var n=e.set.split(".");"true"==t&&(t=!0),"false"==t&&(t=!1);var s=n[0],i=n[1];null==document.getElementById(s)?window[s][i](t):document.getElementById(s)[i]=t})),clearInterval(u))}),100)}render(){return t`<div></div>`}}customElements.define("wa-mqtt",n);export{n as wa_mqtt};
